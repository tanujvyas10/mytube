var _al={playerObj:null,scrollerInterval:null,mousewheelTimeout:null,duration:0,frameRate:0,lyrboxHeight:0,fullHeight:0,scrollOffset:0,isScrolled:0,isAjaxSpinner:0,cleanSongName:"",cleanArtistName:"",searchWikia:function(){_al.currentSite++;_al.xhr=jQuery.ajax({url:"http://lyrics.wikia.com/api.php?fmt=realjson",data:{artist:encodeURIComponent(_al.cleanArtistName),song:encodeURIComponent(_al.cleanSongName)},dataType:"jsonp",jsonp:"callback",jsonpCallback:"_al.handleWikiaResponse"})},handleWikiaResponse:function(a){_al.lastRes=a;if(a.url&&a.lyrics!=""&&a.lyrics!="Not found"){if(a.artist){_al.actualArtist=a.artist}if(a.song){_al.actualSong=a.song}_al.xhr=jQuery.ajax({url:"http://query.yahooapis.com/v1/public/yql?format=xml",data:{q:'SELECT * FROM html WHERE url="'+a.url+'" AND xpath="//div[@class=\'lyricbox\']//p"'},dataType:"jsonp",jsonp:"callback",jsonpCallback:"_al.handleFoundLyrics"})}else{jQuery("#lyrTop").html("No lyrics found")}},handleFoundLyrics:function(c){var b=c.results[0],e=_al.cleanSongName,a=_al.cleanArtistName;if(!b){jQuery("#lyrTop").html('An error occured, please <a href="#" id="lnkRetryLyrics">try again</a> later');jQuery("#lnkRetryLyrics").click(function(){jQuery("#lyrTop").html("Searching for lyrics...");_al.handleWikiaResponse(_al.lastRes);return false});return}if(_al.actualArtist){a=_al.actualArtist}if(_al.actualSong){e=_al.actualSong}_al.showLyrics(a,e,b,_al.currentSite);try{clearInterval(_al.scrollerInterval)}catch(d){}},toggleScroll:function(a){if(!_al.playerObj){return}try{clearInterval(_al.scrollerInterval)}catch(b){}if(a&&_al.isAutoScroll){_al.fullHeight=jQuery("#lyrBox .lyrics div:first-child").height();if(!_al.lyrboxHeight){_al.lyrboxHeight=jQuery("#lyrBox .lyrics").height()/2}_al.scrollerInterval=setInterval(_al.scroll,200)}},scroll:function(){if(_al.duration<2){_al.duration=_al.playerObj.getDuration()}if(_al.frameRate==_al.playerObj.getCurrentTime()/_al.duration){return}_al.frameRate=(_al.playerObj.getCurrentTime()-_al.scrollOffset)/(_al.duration-_al.scrollOffset);var a=_al.fullHeight*_al.frameRate-_al.lyrboxHeight;if(a<0){a=0}else{if(a>_al.fullHeight-_al.lyrboxHeight){a=_al.fullHeight-_al.lyrboxHeight}}jQuery("#lyrBox .lyrics").scrollTop(a)},setScrollOffset:function(){var a=jQuery("#lyrBox .lyrics").scrollTop();_al.scrollOffset=(_al.duration*(a+_al.lyrboxHeight)-_al.fullHeight*_al.playerObj.getCurrentTime())/(_al.lyrboxHeight+a-_al.fullHeight)},preg_quote:function(a){return(a+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")},globalReplace:function(e,d,c,a){var b;if(a){b=new RegExp("("+_al.preg_quote(d)+")","gi")}else{b=new RegExp(d,"g")}return(e.replace(b,c))},endsWith:function(b,a){return b.indexOf(a,b.length-a.length)},showLyrics:function(d,h,a){var c=416,g="Show lyrics",f="";if(_al.isAjaxSpinner){jQuery("#ajaxOverlay").remove();_al.isAjaxSpinner=0}if(a==""||!a){jQuery("#lyrTop").text("No lyrics found");return}a=_al.globalReplace(a,"<br>","|||");a=_al.globalReplace(a,"<br/>","|||");a=_al.globalReplace(a,"<br />","|||");a=_al.globalReplace(a,"\n","");a=_al.globalReplace(a,"\r","");a=_al.globalReplace(a,"\t","");a=jQuery(a).text();lyricsTextArr=a.split("|||");a="";for(var e=0;e<lyricsTextArr.length;e++){if(a==""&&lyricsTextArr[e]==""){continue}a+="<q>"+lyricsTextArr[e]+"</q><br />"}var b=_al.endsWith(a,"<q></q><br />");while(b>=0){a=a.substr(0,b);b=_al.endsWith(a,"<q></q><br />")}if(d!=""&&h!=""){f=d+" - "+h}else{if(d||h){if(d){f=d}else{f=h}}}jQuery("#lyrTop").html('<a id="lnkOpenLyrics" title="'+(f).replace('"',"&quot;")+'" href="#">'+g+"</a>");if(f!=""){f="<br><u><strong>"+f+"</strong></u><br /><br />"}jQuery("#lyrBox .lyrics").html("<div>"+f+a+"<br /><br /></div>");if(jQuery("#lyrBox").hasClass("branded")){c=390}jQuery("#lnkOpenLyrics").click(function(){jQuery("#lyrBox").addClass("opened").animate({height:c+"px"},function(){_al.toggleScroll(1)});return false})},setCookie:function(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+d+a+"; path=/;"}};(function(){function e(){if(typeof(_addLyrStarted)!="undefined"||document.readyState!="complete"){console.log(typeof(_addLyrStarted),document.readyState);return}_addLyrStarted=true;var i="#lyrBox {direction: ltr; position: relative; width:298px; height:21px; border: 1px solid #CCCCCC; box-shadow: 0 1px 2px #EEEEEE inset; text-align:center; padding-top:5px; font-size:12px; margin-bottom:5px; line-height: normal;}#lyrBox, #ajaxOverlay {-webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px;}#lyrBox:hover {filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr=#fffafafa,EndColorStr=#ffdcdcdc);background-image:-moz-linear-gradient(top,#fafafa 0,#dcdcdc 100%);background-image:-ms-linear-gradient(top,#fafafa 0,#dcdcdc 100%);background-image:-o-linear-gradient(top,#fafafa 0,#dcdcdc 100%);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#fafafa),color-stop(100%,#dcdcdc));background-image:-webkit-linear-gradient(top,#fafafa 0,#dcdcdc 100%);background-image:linear-gradient(to bottom,#fafafa 0,#dcdcdc 100%);}#lyrBox.opened {padding:5px 0;}#lyrBox .lyrics {color:black; line-height: 1.3em; display:none; overflow-y: scroll; height:377px;}#lyrBox #ajaxOverlay {position:absolute; top:0; left:0; width:100%; height:100%; filter: alpha(opacity=90); -khtml-opacity: 0.9; -moz-opacity: 0.9; opacity: 0.9; background:url('http://cdn.jsdelivr.net/wp-advanced-ajax-page-loader/2.5.12/loaders/Retrieving%20Spinner%20Blue.gif') no-repeat scroll center center #FFFFFF;}#lyrBox .close {display:none; border-bottom: 1px solid #CCCCCC; padding-bottom:3px;}#lyrBox.opened .close, #lyrBox.opened .bottom, #lyrBox.opened .lyrics {display:block;}#lyrBox .bottom {display:none; border-top: 1px solid #CCCCCC;text-align:center;padding:3px 0 3px 4px;}#lyrBox.opened #lyrTop {display:none;}#lyrBox .lyrics q {float:left; width:271px; padding:0 5px;}#watch7-sidebar #lyrBox {margin-bottom: 12px; margin-left: 10px}#lyrBox + #watch-channel-brand-div {margin-left: 10px}#lyrBox.noscroll .bottom {display:none;}#lyrBox .lyrics q:hover {-webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; background-color:#0FEE6F; color:black; text-shadow: 0 1px 0 #50BC42; cursor:default;}div.tooltip {margin-top: 6px; padding:10px; border:1px solid #CCCCCC; cursor:default; background: white; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#EEEEEF'); background: -webkit-gradient(linear, left top, left bottom, from(#FFFFFF), to(#EEEEEF)); background: -moz-linear-gradient(top,  #FFFFFF,  #EEEEEF); max-width:250px; -webkit-border-radius:5px; -moz-border-radius:5px; border-radius:5px;}.dropdown-menu a.selected{font-weight:bold;}.dropdown-menu{font:14px sans-serif;position:absolute;z-index:9999999;display:none}.dropdown-menu UL{min-width:160px;list-style:none;background:#FFF;border:solid 1px #DDD;border:solid 1px rgba(0,0,0,.2);border-radius:6px;box-shadow:0 5px 10px rgba(0,0,0,.2);overflow:visible;padding:4px 0;margin:0}.dropdown-menu.has-tip{margin-top:8px}.dropdown-menu.has-tip:before{position:absolute;top:-6px;left:9px;content:'';border-left:7px solid transparent;border-right:7px solid transparent;border-bottom:7px solid #CCC;border-bottom-color:rgba(0,0,0,0.2);display:inline-block}.dropdown-menu.has-tip.anchor-right:before{left:auto;right:9px}.dropdown-menu.has-tip:after{position:absolute;top:-5px;left:10px;content:'';border-left:6px solid transparent;border-right:6px solid transparent;border-bottom:6px solid #FFF;display:inline-block}.dropdown-menu.has-tip.anchor-right:after{left:auto;right:10px}.dropdown-menu.has-scroll UL{max-height:358px;overflow:auto}.dropdown-menu LI{list-style:none;padding:0;margin:0;line-height:18px}.dropdown-menu LI>A,.dropdown-menu LABEL{display:block;color:#555;text-decoration:none;line-height:18px;padding:3px 15px;white-space:nowrap}.dropdown-menu LI>A:hover,.dropdown-menu LABEL:hover{background-color:#0FEE6F;color:#FFF;cursor:pointer}.dropdown-menu .divider{height:1px;background:#e5e5e5;margin:5px 1px;overflow:hidden}.dropdown-menu.has-icons LI>A{padding-left:30px;background-position:8px center;background-repeat:no-repeat}.dropdown-menu .undo A{background-image:url('https://raw.github.com/claviska/jquery-dropdown/master/icons/arrow-curve-180-left.png')}.dropdown-menu .redo A{background-image:url('https://raw.github.com/claviska/jquery-dropdown/master/icons/icons/arrow-curve.png')}.dropdown-menu .cut A{background-image:url('https://raw.github.com/claviska/jquery-dropdown/master/icons/icons/scissors.png')}.dropdown-menu .copy A{background-image:url('https://raw.github.com/claviska/jquery-dropdown/master/icons/icons/document-copy.png')}.dropdown-menu .paste A{background-image:url('https://raw.github.com/claviska/jquery-dropdown/master/icons/icons/clipboard.png')}.dropdown-menu .delete A{background-image:url('https://raw.github.com/claviska/jquery-dropdown/master/icons/icons/cross-script.png')}",f=document.getElementsByTagName("head")[0],g=document.createElement("style"),j=document.createTextNode(i);g.type="text/css";if(g.styleSheet){g.styleSheet.cssText=j.nodeValue}else{g.appendChild(j)}f.appendChild(g);if(typeof jQuery=="undefined"){var h=document.createElement("script");h.setAttribute("type","text/javascript");h.setAttribute("src","https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js");if(h.readyState){h.onreadystatechange=function(){if(h.readyState=="loaded"||h.readyState=="complete"){h.onreadystatechange=null;c()}}}else{h.onload=function(){c()}}}else{c()}document.body.appendChild(h)}function a(g){var j=g+"=";var f=document.cookie.split(";");for(var h=0;h<f.length;h++){var k=f[h];while(k.charAt(0)==" "){k=k.substring(1,k.length)}if(k.indexOf(j)==0){return k.substring(j.length,k.length)}}return null}function c(){var i="#watch-sidebar",f="movie_player";if(jQuery(i).length<1){i="#watch7-sidebar"}var k=jQuery("h1 span").attr("title"),j=k.split(" - "),h="off";_al.isAutoScroll=a("addlyricsAutoscroll");if(_al.isAutoScroll==null){_al.isAutoScroll=1}_al.isAutoScroll*=1;if(_al.isAutoScroll!=1){h="on"}var g='<div id="lyrBox" class="yt-uix-button-default"><div id="lyrTop">Searching for lyrics...</div><div class="close"><a href="#" id="lnkCloseLyrics">Hide lyrics</a></div><div class="lyrics"></div><div class="bottom"><a href="#" id="lnkToggleAutoscroll">Turn autoscroll mode <span>'+h+"</span></a></div></div>";jQuery(i).prepend(g);jQuery("#lnkToggleAutoscroll").click(function(){var m=jQuery(this).find("span"),l=0;if(_al.isAutoScroll){m.html("on")}else{m.html("off");l=1}_al.isAutoScroll=l;_al.toggleScroll(l);_al.setCookie("addlyricsAutoscroll",l,365);return false});jQuery("#lnkCloseLyrics").click(function(){_al.toggleScroll(0);jQuery("#lyrBox").animate({height:"21px"},{complete:function(){jQuery(this).removeClass("opened")}});return false});if(j.length>1){_al.cleanArtistName=jQuery.trim(j[0]);_al.cleanSongName=jQuery.trim(j[1])}else{j=k.split("-");if(j.length>1){_al.cleanArtistName=jQuery.trim(j[0]);_al.cleanSongName=jQuery.trim(j[1])}else{_al.cleanSongName=jQuery.trim(k)}}if(_al.cleanArtistName||_al.cleanSongName){d();_al.searchWikia()}else{jQuery("#lyrTop").text("No lyrics found")}_al.playerObj=window.document.getElementById(f);if(!_al.playerObj){_al.playerObj=window.document.getElementById("movie_player-html5")}if(!_al.playerObj){jQuery("#lyrBox").addClass("noscroll");return}jQuery("#lyrBox .lyrics").mousedown(function(l){if(_al.isAutoScroll){if(_al.isScrolled){_al.isScrolled=0}_al.toggleScroll(0)}}).mouseup(function(l){if(_al.isAutoScroll){if(_al.isScrolled){_al.setScrollOffset();_al.isScrolled=0}_al.toggleScroll(1)}}).scroll(function(l){_al.isScrolled=1})}function d(){if(_al.cleanSongName!=""){_al.cleanSongName=_al.globalReplace(_al.cleanSongName," M/V","",true);_al.cleanSongName=_al.globalReplace(_al.cleanSongName," music video","",true);_al.cleanSongName=_al.cleanSongName.replace(/ *\([^)]*\) */g,"");_al.cleanSongName=_al.cleanSongName.replace(new RegExp("\\[.*?\\]","g"),"");_al.cleanSongName=jQuery.trim(_al.cleanSongName);_al.cleanSongName=b(_al.cleanSongName,"feat. ");_al.cleanSongName=b(_al.cleanSongName," feat ");_al.cleanSongName=b(_al.cleanSongName,"ft. ");_al.cleanSongName=_al.globalReplace(_al.cleanSongName," w/ lyrics","",true);_al.cleanSongName=_al.globalReplace(_al.cleanSongName," with lyrics","",true);_al.cleanSongName=_al.globalReplace(_al.cleanSongName," lyrics","",true);_al.cleanSongName=_al.globalReplace(_al.cleanSongName," HQ","",true);_al.cleanSongName=_al.globalReplace(_al.cleanSongName," HD","",true);_al.cleanSongName=_al.globalReplace(_al.cleanSongName,"  "," ")}if(_al.cleanArtistName!=""){_al.cleanArtistName=b(_al.cleanArtistName,"feat. ");_al.cleanArtistName=b(_al.cleanArtistName," feat ");_al.cleanArtistName=b(_al.cleanArtistName,"ft. ");_al.cleanArtistName=_al.globalReplace(_al.cleanArtistName,"  "," ")}}function b(h,g){var f=h.toLowerCase().indexOf(g);if(f>=0){h=h.substr(0,f)}return h}e();if(window.addEventListener){window.addEventListener("load",e,false)}else{if(window.attachEvent){window.attachEvent("onload",e)}}})();